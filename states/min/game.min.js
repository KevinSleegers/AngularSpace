var bounds=$(window).innerWidth(),firebase=new Firebase("https://spacebattalion.firebaseio.com/"),bullets=50;musicToggle=!0,AngularSpace.Game=function(){this.game,this.add,this.camera,this.debug,this.cache,this.input,this.load,this.math,this.sound,this.stage,this.time,this.tweens,this.state,this.world,this.particles,this.physics,this.renderer,this.rnd},AngularSpace.Game.prototype={create:function(){this.physics.startSystem(Phaser.Physics.ARCADE),this.bgMusic=this.game.add.audio("backgroundMusic"),this.bgMusic.play("",0,1,!0),this.bg=this.add.tileSprite(0,0,bounds,bounds,"bg"),this.bg.autoScroll(50,50),this.bullets=this.game.add.group();for(var t=0;bullets>t;t++){var i=this.game.add.sprite(0,0,"bullet");i.animations.add("bulletCollide",[1,2,3,4,5,6]),i.frame=0,this.bullets.add(i),i.anchor.setTo(.5,.5),this.game.physics.enable(i,Phaser.Physics.ARCADE),i.kill()}this.player=this.add.sprite(this.world.centerX,this.world.centerY,"myPlane"),this.player.anchor.setTo(.5,.5),firebase.child("players").set({name:"awesomePl4y3r1337"}),this.game.physics.enable(this.player,Phaser.Physics.ARCADE)},update:function(){var t=this.game.math.distance(this.player.x,this.player.y,this.game.input.activePointer.x,this.game.input.activePointer.y);if(t>32){var i=this.game.math.angleBetween(this.player.x,this.player.y,this.game.input.activePointer.x,this.game.input.activePointer.y);if(this.player.rotation!==i){var s=i-this.player.rotation;s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI),s>0?this.player.angle+=5:this.player.angle-=5,this.player.body.velocity.x=250*Math.cos(i),this.player.body.velocity.y=250*Math.sin(i)}}else this.player.body.velocity.setTo(0,0);this.game.input.activePointer.isDown&&this.shoot()},render:function(){this.game.debug.spriteInfo(this.player,32,32)},shoot:function(){if(void 0===this.lastBulletShotAt&&(this.lastBulletShotAt=0),!(this.game.time.now-this.lastBulletShotAt<100)){this.lastBulletShotAt=this.game.time.now;var t=this.bullets.getFirstDead();null!==t&&void 0!==t&&(t.revive(),t.checkWorldBounds=!0,t.outOfBoundsKill=!0,t.reset(this.player.x,this.player.y),t.rotation=this.player.rotation,this.physics.arcade.velocityFromRotation(t.rotation,500,t.body.velocity))}},audio:function(){this.bgMusic.isPlaying?(this.bgMusic.pause(),musicToggle=!1):(this.bgMusic.resume(),musicToggle=!0)}};